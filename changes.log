
    Complete state preservation: Now saves all game data including:
        Available pets lists (so pets don't reappear after being obtained)
        All pet levels (not just inventory pets)
        Modified stats for all pets (not just inventory)
        Shop state and pending buff choices

    Better error handling:
        Try-catch blocks around database operations
        Error messages sent to stderr
        Return values to indicate success/failure

    Auto-save functionality:
        Game automatically saves after each command (except the save command itself)
        Saves on exit
        Initial state is saved for new games

    Backward compatibility:
        Handles old save formats that might not have all fields
        Reconstructs available pets lists if missing

    Data integrity:
        Validates that pets exist in stats before adding to inventory
        Ensures pet levels are always initialized
        Prevents duplicate pets in inventory

    Performance optimization:
        Only saves modified pet stats (not the entire stats dictionary)
        Efficient JSON serialization
